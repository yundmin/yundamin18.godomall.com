(function(e,t,n){"use strict";var r=t.Modernizr,i=e("body");e.DLMenu=function(t,n){this.$el=e(n);this._init(t)};e.DLMenu.defaults={animationClasses:{classin:"cate_animate_in_1",classout:"cate_animate_out_1"},onLevelClick:function(e,t){return false},onLinkClick:function(e,t){return false}};e.DLMenu.prototype={_init:function(t){this.options=e.extend(true,{},e.DLMenu.defaults,t);this._config();var n={WebkitAnimation:"webkitAnimationEnd",OAnimation:"oAnimationEnd",msAnimation:"MSAnimationEnd",animation:"animationend"},i={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"};this.animEndEventName=n[r.prefixed("animation")]+".dlmenu";this.transEndEventName=i[r.prefixed("transition")]+".dlmenu",this.supportAnimations=r.cssanimations,this.supportTransitions=r.csstransitions;this._initEvents()},_config:function(){this.$menu=this.$el.children("ul.cate_wrap");this.$menuitems=this.$menu.find("li:not(.bn_cate_back)");this.$el.find("ul.cate_bx").prepend('<li class="bn_cate_back"><strong class="cate_tit">'+"back"+"</strong></li>");this.$back=this.$menu.find("li.bn_cate_back")},_initEvents:function(){var t=this;this.$menuitems.on("click.dlmenu",function(n){n.stopPropagation();var r=e(this),i=r.children("ul.cate_bx"),s=r.children(".js_cate_tit").text();i.find("li:eq(0) > .cate_tit").text(s);if(i.length>0){var o=i.clone().css("opacity",0).insertAfter(t.$menu),u=function(){t.$menu.off(t.animEndEventName).removeClass(t.options.animationClasses.classout).addClass("cate_subview");r.addClass("cate_subview_open").parents(".cate_subview_open:first").removeClass("cate_subview_open").addClass("cate_subview");o.remove()};setTimeout(function(){o.addClass(t.options.animationClasses.classin);t.$menu.addClass(t.options.animationClasses.classout);if(t.supportAnimations){t.$menu.on(t.animEndEventName,u)}else{u.call()}t.options.onLevelClick(r,r.children("a:first").text())});return false}else{t.options.onLinkClick(r,n)}});this.$back.on("click.dlmenu",function(n){var r=e(this),i=r.parents("ul.cate_bx:first"),s=i.parent(),o=i.clone().insertAfter(t.$menu);var u=function(){t.$menu.off(t.animEndEventName).removeClass(t.options.animationClasses.classin);o.remove()};setTimeout(function(){o.addClass(t.options.animationClasses.classout);t.$menu.addClass(t.options.animationClasses.classin);if(t.supportAnimations){t.$menu.on(t.animEndEventName,u)}else{u.call()}s.removeClass("cate_subview_open");var e=r.parents(".cate_subview:first");if(e.is("li")){e.addClass("cate_subview_open")}e.removeClass("cate_subview")});return false})},_resetMenu:function(){this.$menu.removeClass("cate_subview");this.$menuitems.removeClass("cate_subview cate_subview_open")}};var s=function(e){if(t.console){t.console.error(e)}};e.fn.dlmenu=function(t){if(typeof t==="string"){var n=Array.prototype.slice.call(arguments,1);this.each(function(){var r=e.data(this,"dlmenu");if(!r){s("cannot call methods on dlmenu prior to initialization; "+"attempted to call method '"+t+"'");return}if(!e.isFunction(r[t])||t.charAt(0)==="_"){s("no such method '"+t+"' for dlmenu instance");return}r[t].apply(r,n)})}else{this.each(function(){var n=e.data(this,"dlmenu");if(n){n._init()}else{n=e.data(this,"dlmenu",new e.DLMenu(t,this))}})}return this}})(jQuery,window)
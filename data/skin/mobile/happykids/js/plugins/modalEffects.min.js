(function(b,a,c){b.Modal=function(d,e){this.$el=b(e);this.init(d)};b.Modal.defaults={remote:"",target:"",toggle:"modal",params:"",cache:true,show:true};b.Modal.prototype={init:function(d){this.options=d;this.$wrapElement=this.$el.find(">.ly_wrap");this.$overlayClass=b(".ly_overlay")},config:function(){},hide:function(){var d=b.Event("hide.ps.modal");this.$el.trigger(d);if(d.isDefaultPrevented()){return}this.$el.removeClass("ly_show");b("body").css({overflow:"inherit"});b(".st-pusher").show();b(a).unbind("resize");if(this.$el.hasClass("ly_setperspective")){b("html").removeClass("ly_perspective")}var e=b.Event("hidden.ps.modal");this.$el.trigger(e);if(e.isDefaultPrevented()){return}},callRemote:function(){var d=this;var f={beforeSend:function(g){g.overrideMimeType("text/html; charset=EUC-KR")},url:this.options.remote,async:false};if(typeof this.options.params=="object"&&this.options.params){f.data=this.options.params}if(this.options.remote){var e=this.options.remote+(!_.isUndefined(f.data)?"?"+b.param(this.options.params):"");b.ajax(f).done(function(g){d.$el.find(".ly_wrap").html(g);storage.saveVal("kCallRemoteUrl",e)})}},show:function(){var f=b.Event("show.ps.modal");this.$el.trigger(f);if(f.isDefaultPrevented()){return}if(!this.$el.find(".ly_wrap").length){this.$el.wrapInner('<div class="ly_wrap"></div>');this.callRemote()}else{if(!this.options.cache){this.$el.find(".ly_wrap").empty();this.callRemote()}}this.$wrapElement.height(b(a).height());this.$el.addClass("ly_show");b("body").css({overflow:"hidden"});b(".st-pusher").hide();var e=this;b(a).bind("resize",function(g){if(e.$el.hasClass("ly_show")){e.$wrapElement.height(b(a).height());b("#wrap").css({height:b(a).height()})}});if(this.$el.hasClass("ly_setperspective")){setTimeout(function(){b("html").addClass("ly_perspective")},25)}location.hash=this.$el.selector;var d=b.Event("shown.ps.modal");this.$el.trigger(d);if(d.isDefaultPrevented()){return}}};b.fn.modal=function(f){var e=b.extend({},b.Modal.defaults,b(this).data(),typeof f=="object"&&f);var d=b.data(this,"ps.modal");if(d){d.init()}else{d=b.data(this,"ps.modal",new b.Modal(e,this))}if(typeof f=="string"){d[f]()}else{if(e.show){d.show()}}b(document).one("click",".ly_btn_close, .ly_overlay",function(g){g.stopPropagation();if(location.hash!=""){history.go(-1)}else{d.hide()}});return this};b.fn.modal.Constructor=b.Modal;b(document).off("click.ps.modal.data-api",'[data-toggle="modal"]').on("click.ps.modal.data-api",'[data-toggle="modal"]',function(i){i.stopPropagation();var h=b(this);var f=_.isUndefined(h.attr("data-remote"))?h.attr("href"):h.data("remote");var d=b(h.attr("data-target")||(f&&f.replace(/.*(?=#[^\s]+$)/,"")));var g=d.data("ps.modal")?"toggle":b.extend({remote:!/#/.test(f)&&f},d.data(),h.data());if(h.is("a")){i.preventDefault()}d.modal(g)});b(a).hashchange(function(d){b(".lypop, .ly_pop").each(function(e){var g="#"+b(this).attr("id");if(g==location.hash){if(!b(g).hasClass("ly_show")){var f="";if(storage.loadVal("kCallRemoteUrl").indexOf(b('[data-target="'+g+'"]').attr("href"))!=-1){f=storage.loadVal("kCallRemoteUrl")}else{f=b('[data-target="'+g+'"]').attr("href")}b('[data-target="'+g+'"]').attr("href",f).trigger("click.ps.modal.data-api")}}else{if(b(g).hasClass("ly_show")){b(g).modal("hide")}}})});b(a).hashchange()})(jQuery,window);